SharePoint アドイン モデルにおけるリスト定義とリスト テンプレート
==============================================================

概要
-------

新しい SharePoint アドイン モデルにおいて、リスト定義 / リスト テンプレートを作成する方法は、完全信頼コードの場合とは異なります。一般的な完全信頼コード (FTC)/ ファーム ソリューション シナリオでは、カスタムのリスト定義 / リスト テンプレートは宣言型コードを使用して作成され、SharePoint ソリューションを使用して展開されていました。 

SharePoint アドイン モデル シナリオでは、実際にカスタムのリスト定義を作成することはできません。この操作は不可能です。ただし、リモート プロビジョニング パターンを使用して Office 365 にカスタム リスト テンプレート (.stp ファイル) を展開することができます。

基本ガイドライン
---------------------

リスト定義 / リスト テンプレートの実装については、大まかに次のような基本ガイドラインが提供されています。

- リスト テンプレート (.stp ファイル) を SharePoint サイトに展開するには、リモート プロビジョニング パターンを使用します。
- 標準のリスト作成動作を上書きし、SharePoint サイトで作成されたすべてのリストに標準化された設定を適用することができます。この方法の詳細については、以下を参照してください。
- 標準化された設定を使用してリストを作成する SharePoint アドインを作成できます。この方法の詳細については、以下を参照してください。

標準化された設定 (テンプレート) を確保するためのオプションは、リスト作成時に SharePoint リストへ適用されます。
------------------------------------------------------------------------------------------------------

標準化された設定 (テンプレート) を、リスト作成時に確実に SharePoint  リストへ適用するオプションはいくつかあります。

- 標準のリスト作成動作を上書きします。   
- SharePoint リストを作成します。 

標準のリスト作成動作を上書きする
--------------------------------------------------
このパターンでは、ListAdded イベントにイベント レシーバーを追加することによって、標準のリスト作成動作を変更します。次に、ListAdded イベント用に構成されたイベント レシーバーで、リモート プロビジョニング パターンを使用し、作成された各リストに標準化された構成を適用します。

これらの標準化された構成は、コンテンツ タイプの追加、既定のコンテンツ タイプの設定、リスト内の列の追加、設定するバージョンの設定、および設定可能なその他のリストの種類の構成が含まれる場合があります。 
    
- このアプローチでは、標準化された設定をすべてのリストに適用できます。
- このアプローチでは、さまざまな種類のリストに標準化された設定を適用できます。
    + 例:ドキュメント ライブラリおよびタスク リストを作成する場合、ListAdded イベントの受信側で、作成したリストの種類を判断し、リストの種類に基づいて異なる標準化された設定を適用できます。おそらくすべてのドキュメント ライブラリに 1 つのコンテンツ タイプのセットを適用し、すべてのタスク リストに別のコンテンツ タイプのセットを適用する必要があります。
- このアプローチでは、リストに複数の異なるテンプレート オプションを適用することはサポートされていません。
    + 例:ドキュメント ライブラリおよびタスク リストを作成する場合、ListAdded イベントの受信側で、作成したリストの種類を判断し、リストの種類に基づいて異なる標準化された設定を適用できます。ただし、1 つのドキュメント ライブラリと、別のドキュメント ライブラリの両方をユーザーが作成する場合、両方に異なるテンプレートを適用することはできません。

**適切な場合**

すべてのリストや特定の種類のリストに標準化されたグローバル設定を適用する必要がある場合。

**適切でない場合**

リストに複数の異なるテンプレート オプションを適用する必要がある場合。

**はじめに**

次 SharePoint アドイン モデル レシピでは、イベント レシーバーを実装する方法について説明します。

- [イベント レシーバー (SharePoint アドイン モデル レシピ)](event-receiver-and-list-event-receiver-sharepoint-add-in.md)

SharePoint アドインを作成する
--------------------------

このパターンでは、標準化された設定を使用して SharePoint アドイン リストを作成し、ユーザーに対して新しいリストを作成するときに SharePoint アドインを使用するよう指示します。基本的には、SharePoint アドインはさまざまなリストの選択肢をユーザーに提供します。SharePoint アドインにより、ユーザーが作成できるさまざまなリストは、ビジネスによって定義され、開発者によって実装されます。ユーザーは SharePoint アドインのフォームを入力してリストのメタデータを指定し、アドインが提供する選択肢の中から作成するリストを選択します。これに応じて、アドインはリモート プロビジョニング パターンを使用してリストを作成します。
    
- このアプローチでは、標準化された設定をすべてのリストに適用できます。
- このアプローチでは、さまざまな種類のリストに標準化された設定を適用できます。
- このアプローチを使用することで、リストに複数の異なるテンプレートのオプションを適用できます。

**適切な場合**

リストに複数の異なるテンプレート オプションを適用する必要がある場合。

**はじめに**

次の PnP O365 コード サンプルとビデオは、ユーザー インターフェイスを提供する SharePoint アドインを作成し、そこでエンド ユーザーに新しいドキュメント ライブラリの作成を許可する方法を示しています。また、まとめてテンプレートとなる特定の構成を使用してドキュメント ライブラリを作成する方法についても示します。

- [ECM.DocumentLibraries (O365 PnP のコード サンプル)](https://github.com/OfficeDev/PnP/tree/master/Samples/ECM.DocumentLibraries)

次のビデオでは、コードのサンプルについて説明します。

- [アプリケーション モデルを使用したドキュメントとリストのテンプレート (O365 PnP ビデオ)](http://channel9.msdn.com/blogs/OfficeDevPnP/Document-and-list-templates-with-app-model)

関連リンク
=============

- [リスト インスタンス (SharePoint アドイン モデル レシピ)](list-instance-sharepoint-add-in.md)
- [イベント レシーバー (SharePoint アドイン モデル レシピ)](event-receiver-and-list-event-receiver-sharepoint-add-in.md)
- [アプリケーション モデルを使用したドキュメントとリストのテンプレート (O365 PnP ビデオ)](http://channel9.msdn.com/blogs/OfficeDevPnP/Document-and-list-templates-with-app-model)
- ガイダンス記事: [http://aka.ms/OfficeDevPnPGuidance](http://aka.ms/OfficeDevPnPGuidance "ガイダンス記事")
- MSDN リファレンス: [http://aka.ms/OfficeDevPnPMSDN](http://aka.ms/OfficeDevPnPMSDN "MSDN リファレンス")
- ビデオ: [http://aka.ms/OfficeDevPnPVideos](http://aka.ms/OfficeDevPnPビデオ"Videos")

関連する PnP サンプル
===================

- [ECM.DocumentLibraries (O365 PnP のコード サンプル)](https://github.com/OfficeDev/PnP/tree/master/Samples/ECM.DocumentLibraries)
- https://github.com/OfficeDev/PnP にあるサンプルとコンテンツ

適用対象
==========
- Office 365 マルチテナント (MT)
- Office 365 専用 (D) *一部*
- SharePoint 2013 オンプレミス - *一部*

*専用およびオンプレミスの場合のパターンは SharePoint アドイン モデル手法と同じですが、使用可能なテクノロジは異なる可能性があります。*
