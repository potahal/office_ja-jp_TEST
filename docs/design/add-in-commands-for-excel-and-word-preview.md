
# Excel、Word および PowerPoint のアドイン コマンド (プレビュー)
アドインでアドイン コマンドを使用して、Excel、Word、および PowerPoint で既定の Office UI を拡張します。

 _ **適用対象:** apps for Office?| Excel 2016?| Office Add-ins?| PowerPoint?| Word 2016_

アドイン コマンドは、既定の Office UI を拡張する UI 要素であり、アドインのアクションを開始します。リボンにボタンを追加したり、コンテキスト メニューに項目を追加したりできます。ユーザーがアドイン コマンドを選択すると、JavaScript コードの実行や、作業ウィンドウでのアドインのページの表示といったアクションを開始します。アドイン コマンドにより、アドインを検索して利用できるようになり、アドインの導入と再利用性が向上し、顧客維持が向上します。

アドイン コマンドを使用して、以下を実行できます。


- ボタン、またはボタンのドロップダウンリストをリボンに追加します。
    
- コンテキスト メニューに、オプションのサブメニューを含め、個々のメニュー項目を追加します。
    
- アドインを表示し、ユーザーが操作する UI を表示します。
    
- 通常は UI を表示しないで実行する JavaScript コードを実行します。
    
- ユーザーがアドインを開く複数の場所を提供することで、アドインが簡単に検索できるようにします。アドインをボタンやコンテキスト メニューから開始したり、 **[挿入]** > **[個人用アドイン]**を使用して開始したりできます。
    
- アドインで様々なページを開きます。これまでは、アドインが開くとき、常に同じページで開始していました。アドインでほかのページに移行するには、コードが UI の移行を管理する必要があります。アドイン コマンドを使用すると、アドインで任意のページを開くことができます。
    
- Excel 2016 または Word 2016 では、一度に複数の作業ウィンドウ アドインが表示されます。
    
Excel および Word のアドイン コマンドの概要については、「[Office のリボンのアドイン コマンド (パブリック プレビュー)](https://channel9.msdn.com/Events/Visual-Studio/Connect-event-2015/316)」をご覧ください。


## アドイン コマンドの作成を開始する

 **アドイン コマンドの利用を開始するには**


1. [Office アドイン コマンドのサンプル](https://github.com/OfficeDev/Office-Add-in-Command-Sample)をダウンロードします。
    
2. 「[Excel、Word、および PowerPoint のマニフェストでアドイン コマンドを作成する (プレビュー)](../../docs/design/create-add-in-commands-in-your-manifest-preview.md)」で説明するように、マニフェストを更新してアドイン コマンドを作成します。ベスト プラクティスについては、「 [Office アドイン開発のベスト プラクティス](../../docs/design/add-in-development-best-practices.md)」をご覧ください。
    

## アドインをインストールしてテストする

マニフェスト ファイルを更新した後で、アドインをインストールしてアドイン コマンドをテストします。アドイン コマンドのテストを以下で実行できます。


- Excel Online
    
- Windows デスクトップ の Office
    

### Excel Online にアドインをインストールします



1. [Microsoft Office Online](https://office.live.com/) を開きます。
    
2.  **[オンライン アプリを今すぐ開始する]** で、 **Excel** > **[空白のブックを新規作成]** > **[挿入]** を選択します。
    
3.  **[アドイン]** で、 **[Office アドイン]** を選択します。
    
4.  **[Office アドイン]** で、 **[マイ アドインのアップロード]** > **[その他]** ( **...**) を選択します。
    
5. コンピューターでマニフェスト ファイルを選択して、 **[アドインのアップロード]** を選択します。
    
6. アドイン コマンドが、リボンまたはコンテキスト メニューのいずれかに表示されることを確認します。
    

### Excel Online のアドイン コマンドの既知の問題



- Excel Online を閉じると、アドインおよびアドイン コマンドも閉じます。次に Excel Online でドキュメントを開くときは、「 [Excel Online にアドインをインストールします](#excel-online-にアドインをインストールします)」の手順をもう一度実行する必要があります。
    
- アドイン コマンドをアドインで利用するには、 **[挿入]** > **[Office アドイン]** > **[マイ アドインのアップロード]** を使用してアドインをアップロードします。Office ストア や SharePoint の社内組織のアドイン カタログに送信されるアドインは、アドイン コマンドを表示しません。
    
- Excel Online のみがアドイン コマンドをサポートします。Word Online および PowerPoint Online のサポートは、将来追加されます。
    
-  **[挿入]** > **[Office アドイン]** > **[自分の所属組織]** を選択して、Office ストア にリダイレクトされる場合は、Excel Online へのサインインを試行してください。次に、 **[自分の所属組織]** をもう一度選択します。
    
- 作業ウィンドウが別のアドイン コマンドを選択した後で作業ウィンドウが更新されない場合は、ブラウザーでページを最新の情報に更新します。
    

### Windows デスクトップで Excel 2016 または Word 2016 にアドインをインストールする


アドインをインストールする前に、Excel 2016 または Word 2016、バージョン 16.0.6326 以上 を実行していることを確認します。


1.  **[Excel 2016]** > **[空白のブック]** > **[ファイル]** > **[アカウント]** を開きます。
    
2.  **Office [更新]** で、バージョン番号が **16.0.6326** 以上であることを確認します。
    
プレビューの開発者向けの機能を含む最新バージョンの Office を取得するには、サブスクリプションに基づいて、以下のいずれかを実行します。


- Office 365 Home、Office 365 Personal、または Office 365 University のサブスクライバーである場合は、 [Office Insider ビルド](https://products.office.com/ja-jp/office-insider)をインストールします。
    
    または
    
- 商用の Office 365 サブスクライバーである場合は、 [先行リリース](https://support.office.com/ja-jp/article/Office-365-release-options-3B3ADFA4-1777-4FF0-B606-FB8732101F47?ui=ja-JP&amp;rs=en-001&amp;ad=JP) をオプトインして、次の手順を実行します。
    

1. [Office 2016 展開ツール](http://www.microsoft.com/en-us/download/details.aspx?id=49117)をダウンロードして実行します。
    
2.  **configuration.xml** を [先行リリース構成ファイル](https://raw.githubusercontent.com/OfficeDev/Office-Add-in-Commands-Samples/master/Tools/FirstReleaseConfig/configuration.xml)に置き換えます。
    
3. 昇格された権限でコメント プロンプト (管理者として実行) を開き、次のコマンドを実行します。
    
  ```
  setup.exe /configuration configuration.xml
  ```

4. Office のバージョン番号が、Excel または Word の場合は  **16.0.6326.0000** 以上であり、PowerPoint の場合は **16.0.6568.2025** 以上であることを確認します。
    
次の手順を実行する前に、アドインがエラーを生成せずに動作していることを確認します。たとえば、Visual Studio を使用しているときは、F5 を押して、アドインがエラーを生成しないで動作していることを確認します。アドインが次の手順を実行した後でエラーを生成する場合、エラーの原因を簡単に特定できます。

 **アドインを Windows デスクトップ** の Office にインストールするには


1. [Office アドイン コマンドのサンプル](https://github.com/OfficeDev/Office-Add-in-Command-Sample) からレジストリ キーをダウンロードして実行し、Office でアドイン コマンドを使用可能にします。
    
2. アドインのマニフェスト ファイルをネットワーク ファイル共有で公開します。詳細については、「 [作業ウィンドウ アドインおよびコンテンツ アドイン用のネットワーク共有フォルダー カタログを作成する](../publish/create-a-network-shared-folder-catalog-for-task-pane-and-content-add-ins.md)」を参照してください。
    
3. Office ホスト アプリケーション (Excel 2016 または Word 2016) を閉じて再び開きます。
    
4.  **[挿入]** > **[個人用アドイン]** > **[共有フォルダー]** を選択します。
    
5. アドインを選択して、 **[OK]** を選択します。
    
6. アドイン コマンドが Office に表示されることを確認します。アドイン コマンドが Office UI に表示されない場合は、 **[挿入]** > **[個人用アドイン]** > **[更新]** を選択します。
    

### Windows デスクトップの Office におけるアドイン コマンドの既知の問題



- Office 365 ProPlus など、クイック実行バージョンの Office を使用している場合、アドインをインストールする前に、更新がインストールを終了していることを確認します。
    
- アドイン コマンドは、Excel 2016、Word 2016、および PowerPoint 2016 でのみサポートされています。
    
- Office ストア または SharePoint の社内組織のアドイン カタログに送信されるアドインは、アドイン コマンドを表示しません。マニフェスト ファイルの読み込みは、ファイル共有からしかできません。
    
- アドイン コマンドの更新は、最新表示しないと Office に表示されません。次のいずれかが発生した場合は、 **[挿入]** > **[個人用アドイン]** > **[更新]** を選択します。
    
      - リボンから、動作しないボタンや重複したボタンは削除することをお勧めします。また、キャッシュのクリーニングを試行するために、 **%LOCALAPPDATA%\Microsoft\Office\16.0\Wef\AppCommands** にあるすべてのファイルを削除して、 **[挿入]** > **[個人用アドイン]** > **[更新]** を選択することもできます。
    
  - 作業ウィンドウ アドイン は読み込まれていません。
    
  - アドイン コマンドを更新する必要があります。アドイン コマンドをリボンに表示するには、2 回更新しなければならないことがあります。
    
- アドインをインストールした後でアイコン ファイルを変更する場合は、次のいずれかの手順を実行できます。
    
      -  **%LOCALAPPDATA%\Microsoft\Office\16.0\Wef\icons** に移動して、そのフォルダー内のすべてのファイルを削除します。
    
    または
    
  - マニフェストの **<Resources>**要素でアイコンのファイル名を変更し、アドイン を再度発行します。
    
- ドキュメントが表示されていない場合でも、アドイン コマンドは常に Office UI で利用できます。
    

## その他の技術情報



- [Excel、Word、および PowerPoint のマニフェストでアドイン コマンドを作成する (プレビュー)](../../docs/design/create-add-in-commands-in-your-manifest-preview.md)
    
- [Office アドイン開発のベスト プラクティス](../../docs/design/add-in-development-best-practices.md)
    
