
# Visual Studio での Office アドインの作成とデバッグ
Visual Studio プロジェクト テンプレートを使用して、Office アドイン プロジェクトを作成し、アドインの設定を変更し、アドインを開発およびデバッグします。

 _ **適用対象:** Access apps for SharePoint?| apps for Office?| Excel?| Office Add-ins?| Outlook?| PowerPoint?| Project?| Word_


 >**メモ**  これらの手順は Visual Studio 2015 に基づいています。その他のバージョンの Visual Studio では、手順が少し異なります。



## Visual Studio で Office アドイン プロジェクトを作成します。


使用を開始するには、Visual Studio の  **Office アドイン** プロジェクト テンプレートを使用します。 **[Office アドイン の作成]** ウィザードでは、作成するアドインの種類を選択するよう求めてから、アドインの既定の構成の選択肢が提供されます。


1. [Visual Studio] メニュー バーで、 **[ファイル]**、 **[新規作成]**、 **[プロジェクト]** の順にクリックします。
    
2. プロジェクトの種類の一覧で、 **[Visual C#]** または **[Visual Basic]** の下にある **[Office/SharePoint]** を展開し、 **[Office アドイン]**、 **[Office アドイン]** の順にクリックします。
    
3. プロジェクトに名前を付け、 **[OK]** をクリックします。
    
4.  **[Office 用アドインの作成]** ダイアログ ボックスが表示されます。作成するアドインの種類を選択して、 **[次へ]** ボタンを選択します。
    
5. 作成するアドインの既定のオプションを選択して、 **[完了]** をクリックします。
    
    Visual Studio がプロジェクトを作成すると、ファイルが **ソリューション エクスプローラー**に表示されます。既定の Home.html ページが Visual Studio で開きます。
    
Visual Studio 2015 で、追加機能を反映するために、次に示す一部のアドイン プロジェクト テンプレートが更新されました。


- コンテンツのアドインは、Excel スプレッドシートに加えて、Access ドキュメントと PowerPoint ドキュメントの本文に表示されます。[Basic Project] オプションを選択すると、最小限のスタート コードで基本のコンテンツ アドイン プロジェクトを作成できます。または、[Document Visualization Project] オプション (Access および Excel のみ) を選択すると、データの視覚化とバインドを行うためのスタート コードが組み込まれているフル機能のコンテンツ アドインを作成できます。
    
- Outlook アドインには、電子メール メッセージや予定内にアドインを組み込むオプションだけでなく、電子メール メッセージや予定の閲覧時や新規作成時にアドインが使用可能かどうか指定するオプションも含まれています。
    

 >**メモ**  Visual Studio では、 **[電子メール メッセージ]** チェック ボックス以外のほとんどのオプションは、説明を読んで理解できます。このチェック ボックスは、メール アイテムだけでなく会議出席依頼、返信、キャンセルでも表示される Outlook アドインを作成する場合に使用します。

ウィザードの完了後、Visual Studio によって 2 つのプロジェクトを含むソリューションが作成されます。



|**プロジェクト**|**説明**|
|:-----|:-----|
|アドイン プロジェクト|アドインを記述するすべての設定を含む XML マニフェスト ファイルのみが含まれます。これらの設定は、Office ホストがアドインをアクティブ化するタイミングと、アドインの表示場所を決定するのに役立ちます。すぐにプロジェクトを実行し、アドインを使用できるように、Visual Studio によってこのファイルのコンテンツが生成されます。これらの設定は、マニフェスト エディターを使用していつでも変更できます。|
|Web アプリケーション プロジェクト|Office 対応の HTML および JavaScript ページを開発するために必要なすべてのファイルとファイル参照を含むアドインのコンテンツ ページが含まれます。アドインを開発している間、Visual Studio は Web アプリケーションをローカル IIS サーバー上でホストします。発行する準備が整ったら、このプロジェクトをホストするサーバーを見つける必要があります。ASP.NET Web アプリケーション プロジェクトの詳細については、「 [ASP.NET Web プロジェクト](http://msdn.microsoft.com/ja-jp/library/cdcd712f-96b0-4165-8b5d-9d0566650a28%28Office.15%29.aspx)」を参照してください。|

## アドイン設定の変更


アドインの設定を変更するには、 **マニフェスト デザイナー**を開きます。マニフェスト デザイナーはプロパティ ページのようなエディターで、アドインの最も一般的な設定をより視覚的に変更できます。 **ソリューション エクスプローラー**から **マニフェスト デザイナー**を開くには、"Office" アドイン プロジェクト ノードを展開し、XML マニフェストが入っているフォルダを選択して、Enter キーを押します。 

アドインのターゲット ロケールなどの詳細設定をするためには、プロジェクトの XML マニフェスト ファイルを直接編集します。 **ソリューション エクスプローラー**で、アドイン プロジェクト ノードを展開し、XML マニフェストが含まれているフォルダーを展開し、XML マニフェストを選択します。ファイル内の要素をポイントすると、その要素の目的を説明するツールヒントを表示できます。説明の完全な一覧については、「 [Office アドインの XML マニフェスト](../../docs/overview/add-in-manifests.md)」を参照してください。

 **マニフェスト デザイナー**には、複数のタブがあります。 **[全般]** には、アドイン名やアイコンなどの全般的なアドイン設定が含まれます。 **[アクティブ化]** では、必要な一連の API とターゲット アプリケーションなどのアドインの要件を指定できます。 **[アプリ ドメイン]** では、アドインが使用するページのドメインを指定できます。Outlook アドインの場合、 **[アクティブ化]** タブがなく、代わりに **[表示フォーム]** と **[作成フォーム]** という 2 つのタブがあります。


### [全般] タブの設定

次の表は、マニフェスト エディターの  **[全般]** タブに表示されるフィールドについて説明しています。



|**プロパティ**|**XML マニフェスト ファイル内で対応する値**|**説明**|
|:-----|:-----|:-----|
|**表示名**|[DisplayName](http://msdn.microsoft.com/ja-jp/library/529159ca-53bf-efcf-c245-e572dab0ef57%28Office.15%29.aspx) 要素の `DefaultValue` 属性。|ホスト アプリケーションの UI に表示される名前。たとえば、Excel では、ユーザーが  **[挿入]**、 **[アドイン]** の順に選択すると、使用できるアドインの一覧にこの名前が表示されます。この名前をアドインの上部にタイトルとして表示することもできます。|
|**アドインの種類**|[OfficeApp](http://msdn.microsoft.com/ja-jp/library/4537b0a6-a741-332d-9e8f-4341c8b50b6a%28Office.15%29.aspx) complexType。|アドインの種類。値 " **作業ウィンドウ アドイン**" は、アドインが Office アプリケーションの作業ウィンドウに表示されることを示します。値 "  **コンテンツ アドイン**" は、アドインがドキュメントの本文に表示されることを示します。値 " **Outlook アドイン**" は、アドインがメッセージや予定表のアイテムの隣に表示されることを示します。|
|**バージョン**|[Version](http://msdn.microsoft.com/ja-jp/library/6a8bbaa5-ee8c-6824-4aba-cb1a804269f6%28Office.15%29.aspx) 要素。|アドインのバージョンを指定します。|
|**プロバイダー名**|[ProviderName](http://msdn.microsoft.com/ja-jp/library/0062693a-fafa-ea2d-051a-75dac0f6c323%28Office.15%29.aspx) 要素。|アドインを開発した個人または会社の名前を指定します。|
|**説明**|[Description](http://msdn.microsoft.com/ja-jp/library/bcce6bad-23d0-7631-7d8c-1064b8453b5a%28Office.15%29.aspx) 要素の `DefaultValue` 属性。|使用できるアドインの一覧でユーザーがアドイン名をポイントしたときに表示される説明。|
|**アイコン**|[IconUrl](http://msdn.microsoft.com/ja-jp/library/c7dac2d4-4fda-6fc7-3774-49f02b2d3e1e%28Office.15%29.aspx) 要素の `DefaultValue` 属性。|ホスト アプリケーションのリボンに表示される、アドインを表す 32 x 32 ピクセルのイメージ。|
|**高解像度のアイコン**|[IconUrl](http://msdn.microsoft.com/ja-jp/library/c7dac2d4-4fda-6fc7-3774-49f02b2d3e1e%28Office.15%29.aspx) 要素の `DefaultValue` 属性。|ホスト アプリケーションのリボンに表示される、アドインを表す 64 x 64 ピクセルのイメージ。|
|**ソースの場所**|[SourceLocation](http://msdn.microsoft.com/ja-jp/library/e6ea8cd4-7c8b-1da7-d8f8-8d3c80a088bc%28Office.15%29.aspx) 要素の `DefaultValue` 属性。|ホスト アプリケーションでアドインがアクティブ化されたときに、アドインに表示される最初のページの場所。このプロパティの既定値は、プロジェクトの既定の HTML ファイルです。|
|**サポート URL**|[SupportUrl](http://msdn.microsoft.com/ja-jp/library/61cff5aa-929f-7d6a-2ce9-0b92b2d6e0a7%28Office.15%29.aspx) 要素の `DefaultValue` 属性。|アドインのサポート情報を提供するページの URL を指定します。|
|**必要な高さ** (コンテンツ アプリおよび Outlook アドインのみ)|[RequestedHeight](http://msdn.microsoft.com/ja-jp/library/fe949c28-a9ff-26dd-6a80-5f81abc330e8.aspx) 要素。|アドインのアドイン ウィンドウの高さに必要なピクセル数。|
|**必要な幅** (コンテンツ アドインのみ)|[RequestedWidth](http://msdn.microsoft.com/ja-jp/library/29032529-6661-fb99-1ff3-c02cc474017f.aspx) 要素。|アドインのアドイン ウィンドウの幅に必要なピクセル数。|
|**アクセス許可**|[Permissions](http://msdn.microsoft.com/ja-jp/library/d4cfe645-353d-8240-8495-f76fb36602fe%28Office.15%29.aspx) 要素。|このアドインが必要とするアクセス許可。|
|**エンティティの強調表示** (Outlook アドインのみ)|[DisableEntityHighlighting 要素 (MailApp complexType) (アプリ マニフェスト スキーマ v1.1)](http://msdn.microsoft.com/library/bf67a8d6-cb8f-7a58-d09d-4d5c7679d10f%28Office.15%29.aspx) 要素。|この Outlook アドインでエンティティの強調表示を無効にするかどうかを指定します。|

### [アクティブ化] タブの設定

このタブを使用すると、アドインをアクティブ化するためにターゲット Office アプリケーション上でサポートする必要がある Office JavaScript API のセットを一覧表示できます。たとえば、アドインをテーブルにバインドする場合には、TableBindings API のセットを一覧に追加します。この機能は、アドインに含まれている機能をサポートしていない Office ホスト上で不注意にアドインをアクティブ化して JavaScript エラーが発生する事態を避けるのに役立ちます。

次の表は、マニフェスト エディターの  **[アクティブ化]** タブに表示されるフィールドを示しています。このタブは、コンテンツ アドインと作業ウィンドウ アドインの場合のみ表示されます。



|**プロパティ**|**説明**|
|:-----|:-----|
|**必要な API のセット**|アドインを正常にアクティブ化するために必要な API セットの名前と最小バージョンを指定することができます。API のセットを追加するには、ドロップダウン リストで選択します。API のセットを削除するには、一覧で選択してから  **[削除]** キーを押します。API のセットを指定すると、その API セットの組み合わせをサポートしている Office クライアントがページに表示されます。
 >**メモ**  一部の API セットは特定の Office クライアントのみをサポートしているので、指定する API セットの数が多くなるほど、アドインをアクティブ化できる Office クライアントの数が少なくなります。

|
|**アプリケーション**|アドインのターゲットにする Office アプリケーションを選択できます。Office 365 および Office 2013 SP1 で使用できるすべてのアプリケーションをターゲットにしたり、特定の Office アプリケーションをターゲットにしたりできます。|
|**IntelliSense**|IntelliSense がすべての Office JavaScript API に関する構文情報を表示するか、 **[必要な API のセット]** 一覧内の API のみに関する構文情報を表示するかを選択できます。|
|**概要**|概要のセクションは、 **[必要な API のセット]** と **[アプリケーション]** の各セクションの入力内容に基づいてアドインがどこでアクティブ化されるか示します。|

### [アプリ ドメイン] タブの設定

[アプリ ドメイン] の設定は、アドインがリモート ドメインと通信 (ドメイン間通信) する必要がある場合に使用されます。次の表は、マニフェスト エディターの  **[アドイン ドメイン]** タブに表示されるフィールドについて説明します。これらの設定により、このアドインがページの読み込みに使用するドメインを指定できます。



|**プロパティ**|**説明**|
|:-----|:-----|
|**ドメインの URL を入力してください**|アドインで使用されるドメインの URL を入力できます。 **[AppDomains]** の一覧に追加するには **[追加]** を選択します。|
|**AppDomains**|指定したアドイン ドメインの一覧。一覧からアイテムを削除するには、そのアイテムを選択してから、 **[削除]** ボタンを選択します。|

### [表示フォーム] タブの設定

表示フォームの設定は、Outlook アドインでのみ利用可能です。これらの設定では、どのような場合に表示フォームのアドインをアクティブ化するかを指定し、さらに表示フォームのアドインの UI プロパティも指定します。


|
|
|**プロパティ**|**説明**|
|:-----|:-----|
|アクティブ化|表示フォームのアドインのアクティブ化ルールを指定します。ツリーペインで適切なルールを選択するか、[ **追加**] ドロップダウン リストを選択して、ルールを追加できます。オプションで、メールまたは予定のアイテムのメッセージ クラスを指定できます。|
|ソースの場所|アドインのソースの場所を指定します。|
|要求された高さ|要求される高さをピクセル単位で指定します。|
|タブレットで開いているアイテムにアドインが表示されるようにする|タブレットにアドインが表示されるようにする場合は、このボックスをオンにします。オンにする場合は、タブレットのコードのソースの場所と、タブレットにおいて要求される高さも指定する必要があります。|
|携帯電話で開いているアイテムにアドインが表示されるようにする|携帯電話にアドインが表示されるようにする場合は、このボックスをオンにします。オンにする場合は、携帯電話のコードのソースの場所も指定する必要があります。|

### [作成フォーム] タブの設定

作成フォームの設定は、Outlook アドインでのみ利用可能です。これらの設定では、どのような場合に作成フォームのアドインをアクティブ化するかを指定し、さらに作成フォームのアドインの UI プロパティも指定します。


|
|
|**プロパティ**|**説明**|
|:-----|:-----|
|アクティブ化|作成フォームのアドインをアクティブ化するアイテムを指定します。 **電子メール メッセージ**または **予約**のいずれかまたは両方を選択できます。 |
|ソースの場所|アドインのソースの場所を指定します。|
|高解像度のアイコン|dpi が高いディスプレイでアドインを表すために使用するイメージの URL を指定します。128 x 128 ピクセルにする必要があります。|
|タブレットで開いているアイテムにアドインが表示されるようにする|タブレットにアドインが表示されるようにする場合は、このボックスをオンにします。オンにする場合は、タブレットのコードのソースの場所も指定する必要があります。|
|携帯電話で開いているアイテムにアドインが表示されるようにする|携帯電話にアドインが表示されるようにする場合は、このボックスをオンにします。オンにする場合は、携帯電話のコードのソースの場所も指定する必要があります。|

## アドインのコンテンツの開発


アドイン プロジェクトはアドインを説明する設定を変更でき、Web アプリケーションはアドインに表示されるコンテンツを提供します。 

Web アプリケーション プロジェクトには、作業の開始時に使用できる既定の HTML ページと JavaScript ファイルが含まれています。また、プロジェクトに追加するすべてのページに共通の JavaScript ファイルも含まれています。JavaScript API for Office などの他の JavaScript ライブラリへの参照が含まれるので、これらのファイルは便利です。 

アドインが高度になるにつれて、追加する HTML ファイルや JavaScript ファイルの数が多くなります。アドインと連動させるためにプロジェクト内の他のページに追加できる参照の種類の例として、既定の HTML ファイルと JavaScript ファイルのコンテンツがあります。次の表は、既定の HTML ファイルと JavaScript ファイルを示しています。



|**ファイル**|**説明**|
|:-----|:-----|
|**Home.html**|アドインの既定の HTML ページで、プロジェクトの  **[Home]** フォルダーに存在します。アドインがドキュメント、電子メール メッセージ、または予定のアイテムでアクティブ化されると、このページがアドイン内の最初のページとして表示されます。このファイルには作業を開始する際に必要となるファイル参照がすべて含まれていて便利です。最初のアドインを作成する準備ができたら、このファイルに HTML コードを追加するだけで済みます。|
|**Home.js**|Home.js ページに関連付けられた JavaScript ファイルで、プロジェクトの  **[Home]** フォルダーに存在します。Home.js ファイルには Home.html ページの動作にとって固有のコードを組み込むことができます。Home.js ファイルには、作業の開始に利用できるサンプル コードが含まれています。|
|**App.js**|アドイン全体の既定の JavaScript ファイルで、プロジェクトの  **[Add-in]** フォルダーに存在します。App.js ファイルにはアドインの複数ページの動作にとって共通のコードを組み込むことができます。App.js ファイルには作業を開始する際に使用できるサンプル コードがいくつか含まれています。|

 >**メモ**  これらのファイルを必ず使用する必要はありません。他のファイルをプロジェクトに追加して代わりに使用してもかまいません。別の HTML ファイルをアドインの初期ページとして表示する場合は、マニフェスト エディターを開き、 **SourceLocation** プロパティにそのファイルの名前を設定します。


## アドインのデバッグ


アドインを起動する準備ができたら、ビルドとデバッグに関連するプロパティを確認してください。確認が終了したら、ソリューションを起動します。


### ビルドおよびデバッグ プロパティの確認

ソリューションを起動する前に、Visual Studio で目的のホスト アプリケーションが開けることを確認します。この情報は、アドインのビルドとデバッグに関連する他のプロパティと共に、プロジェクトのプロパティ ページに表示されます。


### プロジェクトのプロパティ ページを開くには


1.  **ソリューション エクスプ ローラー**で、プロジェクト名を選択します。
    
2. メニュー バーで、[ **表示**]、[ **プロパティ ウィンドウ**] の順に選択します。
    
次の表に、プロジェクトのプロパティを示します。



|**プロパティ**|**説明**|
|:-----|:-----|
|**開始動作**|Office デスクトップ クライアントまたは指定のブラウザー内の Office Online クライアントのどちらでアドインをデバッグするか指定します。|
|**開始ドキュメント** (コンテンツ アドインと作業ウィンドウ アドインのみ)|プロジェクトの開始時に開くドキュメントを指定します。|
|**Web プロジェクト**|アドインに関連付けられている Web プロジェクトの名前を指定します。|
|**電子メール アドレス** (Outlook アドインのみ)|Outlook アドインのテストに使用する Exchange Server か Exchange Online のユーザー アカウントの電子メール アドレスを指定します。|
|**EWS の URL** (Outlook アドインのみ)|Exchange Web サービス の URL (例: https://www.contoso.com/ews/exchange.aspx)。 |
|**OWA の URL** (Outlook アドインのみ)|Outlook Web App の URL (例: https://www.contoso.com/owa).|
|**ユーザー名** (Outlook アドインのみ)|Exchange Server または Exchange Online のユーザー アカウントの名前を指定します。|
|**プロジェクト ファイル**|ビルド、構成、およびその他のプロジェクト情報が含まれているファイルの名前を指定します。|
|**プロジェクト フォルダー**|プロジェクト ファイルの場所です。|

### 既存のドキュメントを使用してアドインをデバッグする (コンテンツ アドインと作業ウィンドウ アドインのみ)


アドイン プロジェクトにドキュメントを追加できます。アドインで使用するテスト データを含むドキュメントがある場合、プロジェクトの開始時に Visual Studio によってそのドキュメントが開かれます。


### 既存のドキュメントを使用してアドインをデバッグするには


1.  **ソリューション エクスプ ローラー**で、アドイン プロジェクト フォルダーを選択します。
    
     >**メモ**  アドイン プロジェクトを選択し、Web アプリケーション プロジェクトは選択しません。
2. [ **プロジェクト**] メニューで、[ **既存の項目の追加**] を選択します。
    
3. [ **既存の項目の追加**] ダイアログ ボックスで、追加するドキュメントを探して選択します。
    
4. [ **追加**] を選択して、ドキュメントをプロジェクトに追加します。
    
5.  **ソリューション エクスプローラー**で、プロジェクトのショートカット メニューを開き、[ **プロパティ**] を選択します。
    
    プロジェクトのプロパティ ページが表示されます。
    
6. [ **開始ドキュメント**] 一覧で、プロジェクトに追加したドキュメントを選択し、[ **OK**] を選択してプロパティ ページを閉じます。
    

### ソリューションの起動


Visual Studio は、起動すると、自動的にソリューションをビルドします。ソリューションを起動するには、 **メニュー** バーから **[デバッグ]**、 **[開始]** の順に選択します。


 >**メモ**  Internet Explorer でスクリプトのデバッグが有効になっていない場合は、Visual Studio のデバッガーを起動できません。スクリプトのデバッグを有効にするには、 **[インターネット オプション]** ダイアログ ボックスを開いて、 **[詳細設定]** タブを選択し、 **[スクリプトのデバッグを使用しない (Internet Explorer)]** チェック ボックスと **[スクリプトのデバッグを使用しない (その他)]** チェック ボックスをオフにします。

Visual Studio はプロジェクトをビルドし、次の操作を実行します。


1. XML マニフェスト ファイルのコピーを作成し、それを  _プロジェクト名_\Output ディレクトリに追加します。このコピーは、Visual Studio を起動してアドインをデバッグするときにホスト アプリケーションで使用されます。
    
2. アドインをホスト アプリケーションに表示するための一連のレジストリ エントリをコンピューターに作成します。
    
3. Web アプリケーション プロジェクトをビルドし、ローカルの IIS Web サーバー (http://localhost) に展開します。 
    
次に、Visual Studio は次の操作を実行します。


1. ~remoteAppUrl トークンを開始ページの完全修飾アドレス (例: http://localhost/MyAgave.html) で置き換えることによって、XML マニフェスト ファイルの [SourceLocation](http://msdn.microsoft.com/ja-jp/library/e6ea8cd4-7c8b-1da7-d8f8-8d3c80a088bc%28Office.15%29.aspx) 要素を変更します。
    
2. IIS Express で Web アプリケーション プロジェクトを起動します。
    
3. ホスト アプリケーションを開きます。 
    
プロジェクトをビルドする際、Visual Studio は **出力**ウィンドウに検証エラーを表示しません。Visual Studio は、エラーと警告を、発生時に  **ERRORLIST** ウィンドウ内で報告します。Visual Studio は、コードおよびテキスト エディター内で検証エラーを別の色の波形の下線 (波線と呼びます) で示します。このようなマークにより、Visual Studio がコード内で検出した問題が通知されます。詳細については、「 [コードおよびテキスト エディター](http://go.microsoft.com/fwlink/?LinkID=128497)」を参照してください。検証を有効化または無効化する方法の詳細については、次のトピックを参照してください。 


- [[オプション]、 [テキスト エディター]、[JavaScript]、[IntelliSense]](http://go.microsoft.com/fwlink/?LinkID=238779)
    
- [方法: Visual Web Developer で HTML 編集用の検証オプションを設定する](http://msdn.microsoft.com/ja-jp/library/vstudio/0byxkfet%28v=vs.100%29.aspx)
    
- [[検証] ([オプション] ダイアログ ボックス - [テキスト エディター] - [CSS])](http://go.microsoft.com/fwlink/?LinkID=238780)
    
プロジェクト内の XML マニフェスト ファイルの検証ルールを確認するには、「 [Office アドインの XML マニフェスト](../../docs/overview/add-in-manifests.md)」を参照してください。


### Excel、Word、または Project にアドインを表示し、コードをステップ実行する


アドイン プロジェクトの **開始ドキュメント** プロパティを Excel または Word に設定した場合、Visual Studio はドキュメントを新規作成し、アドインが表示されます。アドイン プロジェクトの **開始ドキュメント** プロパティを既存のドキュメントを使用するように設定した場合、Visual Studio はドキュメントを開きますが、アドインは手動で挿入する必要があります。 **開始ドキュメント** を **Microsoft Project** に設定した場合も、アドインを手動で挿入する必要があります。


### Office アドイン を Excel または Word で表示するには


1. Excel または Word の  **[挿入]** タブで、 **[Office アドイン]** を選択します。
    
2. 表示される一覧で、アドインを選択します。
    

### Project で Office アドインを表示するには


1. Project の  **[プロジェクト]** タブで、 **[Office アドイン]** を選択します。
    
2. 表示される一覧で、アドインを選択します。
    
Visual Studio でブレークポイントを設定できます。ブレークポイントを設定したら、アドインを操作し、HTML、JavaScript、および C# か VB のコード ファイル内のコードをステップ実行します。


### Outlook で Outlook のアドインを表示し、コードをステップ実行する


Outlook でアドインを表示するには、電子メール メッセージまたは予定アイテムを開きます。

Outlook は、アクティブ化の基準を満たしていれば、アイテムの アドイン をアクティブ化します。アドイン バーが [インスペクタ] ウィンドウまたは閲覧ウィンドウの上部に表示され、Outlook アドインが アドイン バーにボタンとして表示されます。アドインにアドイン コマンドがある場合は、リボンの既定のタブまたは指定されたカスタム タブのいずれかにボタンが表示され、アドイン バーにはアドインは表示されません。 

Outlook アドインを表示するには、Outlook アドインのボタンを選択します。

Visual Studio では、ブレークポイントを設定できます。ブレークポイントを設定した後、Outlook アドインを操作して、HTML、JavaScript、および C# または VB のコード ファイルのコードをステップ実行します。 

また、コードを変更してから、Office アドイン を終了してプロジェクトを再度起動しなくても、Outlook アドインへの影響を確認することができます。Outlook で Outlook アドインのショートカット メニューを開き、 **[再読み込み]** を選択します。


### コードを変更した後、プロジェクトを再び開始することなくアドインのデバッグを続行する


コードを変更したら、ホスト アプリケーションを閉じてプロジェクトを再起動しなくても、アドインに対する変更の影響を確認することができます。コードを変更した後、アドインのショートカット メニューを開き、 **[再読み込み]** を選択します。アドインを再読み込みすると、アドインは Visual Studio デバッガーと切断された状態になります。そのため、変更の影響を確認することはできても、利用できるすべての Iexplore.exe プロセスに Visual Studio デバッガーをアタッチするまでは、コードをステップ実行していくことはできません。


### 使用可能な Iexplore.exe プロセスのすべてに Visual Studio デバッガーをアタッチするには


1. Visual Studio で、 **[デバッグ]**、 **[プロセスにアタッチ]** の順に選択します。
    
2. [ **プロセスにアタッチ**] ダイアログ ボックスで、利用可能なすべての  **Iexplore.exe** プロセスを選択して、 [ **アタッチ**] を選択します。
    

## 次の手順



- [Visual Studio を使用して作業ウィンドウ アドインまたはコンテンツ アドインを作成する](create-a-task-pane-or-content-add-in-with-visual-studio.md)
    
- [発行のための準備として Napa または Visual Studio を使用してアドインをパッケージ化する](../publish/package-your-add-in-using-napa-or-visual-studio.md)
    
