
# SolverSave 函数

保存工作表中的规划求解问题说明。


 **注释**  规划求解加载项默认处于禁用状态。使用此函数之前，必须先安装并启用规划求解加载项。有关如何执行该操作的信息，请参阅[使用规划求解 VBA 函数](37d0aa49-2e5c-5efe-1c69-b5168af1f231.md)。安装规划求解加载项之后，必须创建对该规划求解加载项的引用。在 Visual Basic 编辑器中，在一个模块处于活动状态的情况下，单击 **"工具"**菜单上的 **"引用"**，然后选择 **"可使用的引用"**下面的 **"规划求解"**。如果 **"规划求解"**没有显示在 **"可使用的引用"**下面，请单击 **"浏览"**，然后打开 \Program Files\Microsoft Office\Office14\Library\SOLVER 子文件夹中的 Solver.xlam。


 **SolverSave( _SaveArea_ )**

 **SaveArea** **Variant** 类型，必需。指定要将规划求解模型保存在的单元格区域。如果该单元格区域是单个单元格区域，则规划求解将根据需要使用任意数量的单元格将模型保存在以指定单元格开始的列中。如果该单元格区域是多单元格区域，则规划求解仅使用该区域中的单元格，即使无法完整地保存模型也是如此。 ** _SaveArea_** 参数所代表的区域可位于任意工作表上，但如果该工作表不活动，则必须指定该工作表。例如，即使 Sheet2 不是活动工作表， `SolverSave("Sheet2!A1:A3")` 也会将模型保存到 Sheet2 中。

## 示例

本示例使用规划求解函数来使商务问题中的总利润达到最大值。 **SolverSave** 函数将当前问题保存到活动工作表上的某一区域。


```
Worksheets("Sheet1").Activate 
SolverReset 
SolverOptions Precision:=0.001 
SolverOK SetCell:=Range("TotalProfit"), _ 
 MaxMinVal:=1, _ 
 ByChange:=Range("C4:E6") 
SolverAdd CellRef:=Range("F4:F6"), _ 
 Relation:=1, _ 
 FormulaText:=100 
SolverAdd CellRef:=Range("C4:E6"), _ 
 Relation:=3, _ 
 FormulaText:=0 
SolverAdd CellRef:=Range("C4:E6"), _ 
 Relation:=4 
SolverSolve UserFinish:=False 
SolverSave SaveArea:=Range("A33")
```

