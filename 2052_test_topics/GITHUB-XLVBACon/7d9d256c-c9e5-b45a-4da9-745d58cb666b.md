
# 初始化控件属性

您可以通过在宏中使用 Visual Basic 代码在运行时初始化[控件](a85149e1-459e-f83b-3171-467a7e29ca28.md)。例如，您可在其中填充列表框中，设置文本值或设置选项按钮。

以下示例使用  **AddItem** 方法向列表框中添加数据。然后它设置文本框的值并显示窗体。



```
Private Sub GetUserName() 
 With UserForm1 
 .lstRegions.AddItem "North" 
 .lstRegions.AddItem "South" 
 .lstRegions.AddItem "East" 
 .lstRegions.AddItem "West" 
 .txtSalesPersonID.Text = "00000" 
 .Show 
 ' ... 
 End With 
End Sub
```

还可以在窗体的  **Initialize** 事件中用代码设置窗体上控件的初始值。在 **Initialize** 事件中设置控件的初始值的好处在于：初始化代码与窗体存储在一起。您可以将该窗体复制到其他项目中，这样，当运行 **Show** 方法来显示对话框时，将初始化其中的控件。



```
Private Sub UserForm_Initialize() 
 UserForm1.lstNames.AddItem "Test One" 
 UserForm1.lstNames.AddItem "Test Two" 
 UserForm1.txtUserName.Text = "Default Name" 
End Sub
```

