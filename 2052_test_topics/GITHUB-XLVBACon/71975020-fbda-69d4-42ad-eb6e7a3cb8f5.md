
# 代码运行时使用控件值

可以设置并返回 Visual Basic 代码运行时 **[控件](a85149e1-459e-f83b-3171-467a7e29ca28.md)** 的某些属性。下面的示例设置 **Text** 属性的文本框中为"Hello"。


```
TextBox1.Text = "Hello"
```


关闭窗体时，用户在窗体中输入的数据将丢失。如果在卸载窗体后返回其中控件的值，则得到的是控件的初始值而非用户输入的值。

如果要保存在窗体中输入的数据，可以当窗体还在运行时将该信息保存到模块级变量中。以下示例显示一个窗体并保存窗体数据。



```
' Code in module to declare public variables. 
Public strRegion As String 
Public intSalesPersonID As Integer 
Public blnCancelled As Boolean 
 
' Code in form. 
Private Sub cmdCancel_Click() 
 Module1.blnCancelled = True 
 Unload Me 
End Sub 
 
Private Sub cmdOK_Click() 
 ' Save data. 
 intSalesPersonID = txtSalesPersonID.Text 
 strRegion = lstRegions.List(lstRegions.ListIndex) 
 Module1.blnCancelled = False 
 Unload Me 
End Sub 
 
Private Sub UserForm_Initialize() 
 Module1.blnCancelled = True 
End Sub 
 
' Code in module to display form. 
Sub LaunchSalesPersonForm() 
 frmSalesPeople.Show 
 If blnCancelled = True Then 
 MsgBox "Operation Cancelled!", vbExclamation 
 Else 
 MsgBox "The Salesperson's ID is: " &amp; 
 intSalesPersonID &amp; _ 
 "The Region is: " &amp; strRegion 
 End If 
End Sub
```

