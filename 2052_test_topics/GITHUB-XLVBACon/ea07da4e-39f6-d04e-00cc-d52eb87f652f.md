
# 将文档保存为网页

在 Microsoft Excel 中，可以将工作簿、工作表、图表、区域、查询表、数据透视表、打印区域或自动筛选区域保存到网页中。也可以直接在 Excel 中编辑 HTML 文件。


## 将文档保存为网页

将文档保存为 Web 页时创建并保存 HTML 文件及任何支持文件的过程。若要执行此操作，请使用 **[SaveAs](fbc3ce55-27a3-aa07-3fdb-77b0d611e394.md)** 方法，如下面的示例将活动工作簿另存为 C:\Reports\myfile.htm 中所示。


```
ActiveWorkbook.SaveAs _ 
 Filename:="C:\Reports\myfile.htm", _ 
 FileFormat:=xlHTML
```


## 自定义网页

编辑支持、 图形格式、 屏幕分辨率、 文件组织和 HTML 文档的编码设置的 **[DefaultWebOptions](5bd1d870-e8d9-cac1-d7a7-3aeaf7c4c3cd.md)** 对象和 **[web 选项](d573637f-1891-4602-c961-091795e47356.md)** 对象属性，您可以自定义的外观，内容，浏览器支持。 **DefaultWebOptions** 对象包含应用程序级的属性。由具有相同的名称 (这些都包含在 **web 选项** 对象) 的任何工作簿级的属性设置将重写这些设置。

设置属性后，可使用 **[Publish](3bb70102-c440-8e49-1734-d72945324d5c.md)** 方法将工作簿、 工作表、 图表、 区域、 查询表、 数据透视表、 打印区域或自动筛选区域保存到网页。下例设置各种应用程序级属性，然后设置覆盖应用程序级的默认设置活动工作簿的 **[AllowPNG](4fad6401-af54-ad7f-a46f-8110e8c00ad4.md)** 属性。最后，该示例将范围另存为"C:\Reports\1998_Q1.htm"。




```
With Application.DefaultWebOptions 
 .RelyonVML = True 
 .AllowPNG = True 
 .PixelsPerInch = 96 
End With 
With ActiveWorkbook 
 .WebOptions.AllowPNG = False 
 With .PublishObjects(1) 
 .FileName = "C:\Reports\1998_Q1.htm" 
 .Publish 
 End With 
End With
```

也可以直接将文件保存到 Web 服务器上。下例将一个区域保存到 Web 服务器上，假定该网页的 URL 地址为 http://example.homepage.com/annualreport.htm。




```
With ActiveWorkbook 
 With .WebOptions 
 .RelyonVML = True 
 .PixelsPerInch = 96 
 End With 
 With .PublishObjects(1) 
 .FileName = _ 
 "http://example.homepage.com/annualreport.htm" 
 .Publish 
 End With 
End With
```


## 在 Microsoft Excel 中打开 HTML 文档

要编辑在 Excel 中的 HTML 文档，请首先通过使用 **[Open](1d1c3fca-ae1a-0a91-65a2-6f3f0fb308a0.md)** 方法打开的文档。下面的示例打开文件进行编辑"C:\Reports\1997_Q4.htm"。


```
Workbooks.Open Filename:="C:\Reports\1997_Q4.htm"
```

打开文件后，可通过设置  **DefaultWebOptions** 和 **WebOptions** 对象的属性来自定义该 HTML 文档的外观、内容、浏览器支持、编辑支持、图像格式、屏幕分辨率、文件组织和编码。

