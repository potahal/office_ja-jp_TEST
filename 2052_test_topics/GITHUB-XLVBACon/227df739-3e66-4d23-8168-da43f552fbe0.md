
# 创建或替换工作表

下面的示例显示如何确定一个工作表是否存在，以及如何创建或替换工作表。

 **示例代码提供者：** Tom Urtis，[Atlas Programming Management](http://www.atlaspm.com/)

## 确定工作表是否存在

此示例演示如何通过使用  **[Worksheet](182b705e-854a-81cc-a4b0-59b942de55ae.md)** 对象的 **[Name](3d000cdf-5e81-8701-ca7f-bdcce006363b.md)** 属性确定是否存在名为"Sheet4"的工作表。工作表的名称由 `mySheetName` 变量指定。


```
Sub TestSheetYesNo()
    Dim mySheetName As String, mySheetNameTest As String
    mySheetName = "Sheet4"
    
    On Error Resume Next
    mySheetNameTest = Worksheets(mySheetName).Name
    If Err.Number = 0 Then
        MsgBox "The sheet named ''" &amp; mySheetName &amp; "'' DOES exist in this workbook."
    Else
        Err.Clear
        MsgBox "The sheet named ''" &amp; mySheetName &amp; "'' does NOT exist in this workbook."
    End If
End Sub
```


## 创建工作表

此示例演示如何确定是否存在名为"Sheet4"的工作表。工作表的名称由  `mySheetName` 变量指定。如果工作表不存在，此示例演示如何通过使用 **[Worksheets](5ec467a6-97e3-98d7-0b14-845d20c15910.md)** 对象的 **[Add](c771d87a-64e1-e292-9db4-54386a69301e.md)** 方法创建名为"Sheet4"的工作表。


```
Sub TestSheetCreate()
    Dim mySheetName As String, mySheetNameTest As String
    mySheetName = "Sheet4"
    
    On Error Resume Next
    mySheetNameTest = Worksheets(mySheetName).Name
    If Err.Number = 0 Then
        MsgBox "The sheet named ''" &amp; mySheetName &amp; "'' DOES exist in this workbook."
    Else
        Err.Clear
        Worksheets.Add.Name = mySheetName
        MsgBox "The sheet named ''" &amp; mySheetName &amp; "'' did not exist in this workbook but it has been created now."
    End If
End Sub
```


## 替换工作表

此示例演示如何确定是否存在名为"Sheet4"的工作表。工作表的名称由  `mySheetName` 变量指定。如果工作表存在，此示例演示如何使用 **Worksheet** 对象的 **[Delete](a51e1673-e09d-824f-1acc-dda18c120204.md)** 方法删除现有工作表，然后创建名为"Sheet4"的新工作表。


 **重要信息**  删除工作表时，将删除名为"Sheet4"的原始工作表上的所有数据。


```
Sub TestSheetReplace()
    Dim mySheetName As String
    mySheetName = "Sheet4"
    
    Application.DisplayAlerts = False
    On Error Resume Next
    Worksheets(mySheetName).Delete
    Err.Clear
    Application.DisplayAlerts = True
    Worksheets.Add.Name = mySheetName
    MsgBox "The sheet named ''" &amp; mySheetName &amp; "'' has been replaced."
End Sub
```


## 关于参与者
<a name="AboutContributor"> </a>

MVP Tom Urtis 是 Atlas Programming Management（提供 Microsoft Office 和 Excel 业务解决方案全面服务的公司，位于硅谷）的创始人。Tom 在业务管理和开发 Microsoft Office 应用程序方面拥有超过 25 年的经验，并协助编写了"Holy Macro! It's 2,500 Excel VBA Examples" 。

