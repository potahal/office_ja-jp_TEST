
# Sending Email to a List of Recipients Using Excel and Outlook

下面的代码示例演示如何以电子邮件发送给一组收件人根据存储在工作簿中的数据。收件人的电子邮件地址必须在列 A 中，并且该电子邮件的正文文本必须是活动工作表上的第一个文本框中。

 **示例提供的代码:** 神圣的宏!书中，[神圣宏!它是 2500 Excel VBA 示例](http://www.mrexcel.com/store/index.php?l=product_detail&amp;p=1)



```
Sub Sample()
   'Setting up the Excel variables.
   Dim olApp As Object
   Dim olMailItm As Object
   Dim iCounter As Integer
   Dim Dest As Variant
   Dim SDest As String
   
   'Create the Outlook application and the empty email.
   Set olApp = CreateObject("Outlook.Application")
   Set olMailItm = olApp.CreateItem(0)
   
   'Using the email, add multiple recipients, using a list of addresses in column A.
   With olMailItm
       SDest = ""
       For iCounter = 1 To WorksheetFunction.CountA(Columns(1))
           If SDest = "" Then
               SDest = Cells(iCounter, 1).Value
           Else
               SDest = SDest &amp; ";" &amp; Cells(iCounter, 1).Value
           End If
       Next iCounter
       
    'Do additional formatting on the BCC and Subject lines, add the body text from the spreadsheet, and send.
       .BCC = SDest
       .Subject = "FYI"
       .Body = ActiveSheet.TextBoxes(1).Text
       .Send
   End With
   
   'Clean up the Outlook application.
   Set olMailItm = Nothing
   Set olApp = Nothing
End Sub
```


## 有关参与者
<a name="AboutContributor"> </a>

Holy Macro! Books 主要出版娱乐书籍，供使用 Microsoft Office 的人员阅读。单击 MrExcel.com，查看完整的目录。

