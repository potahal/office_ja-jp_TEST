
# 迷你图对进行动画处理

通过使用[SparklineGroup](cc694d97-a3d3-3473-2e37-0ede67b97680.md)对象的[ModifySourceData](35c1c1ed-b61d-2412-961f-8eb74b5563a2.md)方法来循环访问数据的范围，您可以动态显示迷你图。本示例采用 36 个月的数据并播放其动画效果显示的第一年的数据，然后循环访问每个后续月直到到达最后一个月的数据。计数器用于降低动画，这样可以更轻松地查看。此示例需要一个包含区域 a2: a4 表示数据范围 B2:AK4 中的三个迷你的迷你图组。


```
Sub SparkAnimation()

    ' The group of sparklines to animate
    Dim oSparkGroup As SparklineGroup
    'variables for the loop
    Dim i As Integer, j As Integer
    
    ' Set up the sparkline group variable
    Set oSparkGroup = Sheet1.Range("A2").SparklineGroups(1)
    
    ' Set the data source to the first year of data
    oSparkGroup.ModifySourceData "B2:M4"
    
    ' Loop through the data points for the subsequent two years
    For i = 1 To 24
        ' Move the reference for the sparkline group over one cell
        oSparkGroup.ModifySourceData Range(oSparkGroup.SourceData).Offset(, 1).Address
        
        ' Slow the animation
        j = 1
        Do
            j = j + 1: DoEvents
        Loop Until j = 4000
    Next i
    
End Sub
```


## 另请参阅


#### 概念


[SparklineGroup 对象](cc694d97-a3d3-3473-2e37-0ede67b97680.md)
#### 其他资源


[SparklineGroup 成员](http://msdn.microsoft.com/library/dad308ee-d69b-748d-d0c8-ad63c643808f%28Office.15%29.aspx)
[使用 Excel 中的迷你图编程](http://msdn.microsoft.com/library/e26f3356-882e-44d5-94a5-c7e8d1026d78%28Office.15%29.aspx)