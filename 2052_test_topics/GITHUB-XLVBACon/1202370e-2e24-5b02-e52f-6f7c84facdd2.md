
# 嵌入图表事件的用法

默认情况下，图表工作表的事件都是可用的。但在使用代表嵌入图表的  **Chart** 对象事件之前，必须新建一个类模块并声明一个带有事件的 **Chart** 类型对象。例如，假定创建了新的类模块并将其命名为 EventClassModule。该模块内应包含下列代码。


```
Public WithEvents myChartClass As Chart
```


在带事件声明了新的对象之后，该对象将出现在类模块的"对象"下拉列表框中；此时就可为该对象编写事件过程了（在"对象"下拉列表框中选定新对象后，"过程"下拉列表框中将列出该对象的有效事件）。

在事件过程运行之前，必须将类模块中声明的对象与嵌入图表连接起来。可在任意的模块中用下列代码完成这一操作。



```
Dim myClassModule As New EventClassModule 
 
Sub InitializeChart() 
 Set myClassModule.myChartClass = _ 
 Charts(1).ChartObjects(1).Chart 
End Sub
```

运行 InitializeChart 过程之后，类模块中的  `myChartClass` 对象指向工作表 1 上的嵌入图表 1，事件发生时，类模块中的事件过程将运行。
