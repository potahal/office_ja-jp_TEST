
# SolverFinish 函数

指示 Microsoft Office Excel 当求解过程完成后，如何处理结果及创建何种报告。


 **注释**  规划求解加载项默认处于禁用状态。使用此函数之前，必须先安装并启用规划求解加载项。有关如何执行该操作的信息，请参阅[使用规划求解 VBA 函数](37d0aa49-2e5c-5efe-1c69-b5168af1f231.md)。安装规划求解加载项之后，必须创建对该规划求解加载项的引用。在 Visual Basic 编辑器中，在一个模块处于活动状态的情况下，单击 **"工具"**菜单上的 **"引用"**，然后选择 **"可使用的引用"**下面的 **"规划求解"**。如果 **"规划求解"**没有显示在 **"可使用的引用"**下面，请单击 **"浏览"**，然后打开 \Program Files\Microsoft Office\Office14\Library\SOLVER 子文件夹中的 Solver.xlam。


 **SolverFinish** ( ** _KeepFinal_**, ** _ReportArray_**, ** _OutlineReports_** )

 **KeepFinal** **Variant** 类型，可选。可为 1 或 2。如果 ** _KeepFinal_** 为 1 或被省略，则最终结果的值将保存于可变单元格中，取代其原有值。如果 ** _KeepFinal_** 为 2，就丢弃最终结果的值而恢复单元格原有值。
 **ReportArray** **Variant** 类型，可选。完成规划求解时 Excel 将创建的报告种类。

- 当使用"单工 LP"或"GRG 非线性求解"方法时，1 会创建一个"解答"报告，2 会创建一个"敏感度"报告，3 会创建一个"限制"报告。
    
- 使用"进化求解"方法时，1 会创建一个"解答"报告，2 会创建一个"总体"报告。
    
- 当  **[SolverSolve](40ef53c8-ff54-bdc8-9f8b-bf9a4445ce51.md)** 返回 5 时（规划求解找不到可行解），则 1 会创建"可行性"报告，2 会创建"可行性界限"报告。
    
- 当  **SolverSolve** 返回 7 时（不满足线性条件），1 会创建"线性"报告。
    
使用  **Array** 函数可指定要显示的报告，例如， `ReportArray:= Array(1,3)`。
 **OutlineReports** **Variant** 类型，可选。可以为 **True** 或 **False** 。如果 ** _OutlineReports_** 为 **False** 或被忽略，则报告以"常规"格式生成，且没有大纲。如果 ** _OutlineReports_** 为 **True** ，则生成的报告带有大纲组，这些组与您为决策变量和约束输入的单元格区域相对应。

## 示例

本示例加载先前计算过的规划求解模型（该模型存储于 Sheet1 中），并再次求解该模型，然后在新工作表上生成答案报告。


```
Worksheets("Sheet1").Activate 
SolverLoad LoadArea:=Range("A33:A38") 
SolverSolve UserFinish:=True 
SolverFinish KeepFinal:=1, ReportArray:=Array(1)
```

