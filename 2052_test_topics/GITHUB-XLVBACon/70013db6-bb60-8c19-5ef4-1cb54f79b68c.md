
# 页眉和页脚的格式代码和 VBA 代码

下列特殊的格式代码和 Visual Basic for Applications (VBA) 代码（ **[LeftHeader](445461f8-e804-2070-e484-88337aca3407.md)** 、 **[CenterHeader](e8f9ab4e-4f25-0378-0959-97a8cfefc7b6.md)** 、 **[RightHeader](97e1780d-d511-d433-0e31-501381e6318d.md)** 、 **[LeftFooter](ec88bfe1-039e-7d8d-43c3-d8b1771f7f36.md)** 、 **[CenterFooter](b8fc6bc5-9cf3-3b47-5d9f-9ade28c2d775.md)** 和 **[RightFooter](457fb633-d748-bfc4-9188-87b0a46209dc.md)** ）可作为页眉和页脚的属性的一部分。



|**格式代码**|**说明**|
|:-----|:-----|
|&amp;L|后续字符左对齐。|
|&amp;C|后续字符居中。|
|&amp;R|后续字符右对齐。|
|&amp;E|打开或关闭打印双下划线功能。|
|&amp;X|打开或关闭打印上标字符功能。|
|&amp;Y|打开或关闭打印下标字符功能。|
|&amp;B|打开或关闭打印加粗字符功能。|
|&amp;I|打开或关闭打印倾斜字符功能。|
|&amp;U|打开或关闭打印下划线功能。|
|&amp;S|打开或关闭打印删除线功能。|
|&amp;"fontname"|以指定的字体打印后续字符。确保包含了双引号。|
|&amp;nn|以指定的字体大小打印后续字符。用一个 2 位数字指定以磅为单位的大小。|
|&amp;color|以指定颜色打印字符。用户提供十六进制颜色值。|
|&amp;"+"|以当前主题的 **"标题"**字体打印后续字符。确保包含了双引号。|
|&amp;"-"|以当前主题的 **"正文"**字体打印后续字符。确保包含了双引号。|
|&amp;K _xx_. _S_ _yyy_|以当前主题中的指定颜色打印后续字符。xx 是数值为 1 到 12 的两位数字，用于指定要使用的主题颜色。 _S_ _yyy_ 指定主题颜色的底纹（淡色）。将 _S_ 指定为 + 可生成较亮的底纹；将 _S_ 指定为 - 可生成较暗的底纹。 _yyy_ 是三位整数，用于指定从 0 到 100 的百分比。
如果指定主题颜色或底纹的值不在所述的限制范围内，则 Excel 将使用最接近的有效值。|


|**VBA 代码**|**说明**|
|:-----|:-----|
|&amp;D|打印当前日期。|
|&amp;T|打印当前时间。|
|&amp;F|打印文档名称。|
|&amp;A|打印工作簿标签名称。|
|&amp;P|打印页号。|
|&amp;P+数字|打印页号加上指定数字。|
|&amp;P-数字|打印页号减去指定数字。|
|&amp;&amp;|打印单个和号。|
|&amp;N|打印文档的总页数。|
|&amp;Z|打印文件路径。|
|&amp;G|插入图像。|

## 示例

以下代码显示如何使用格式代码和 VBA 代码来修改页眉信息和外观。


```
Sub Date_Time() 
 ActiveSheet.PageSetup.CenterHeader = "&amp;D &amp;B&amp;ITime:&amp;I&amp;B&amp;T" 
End Sub
```

