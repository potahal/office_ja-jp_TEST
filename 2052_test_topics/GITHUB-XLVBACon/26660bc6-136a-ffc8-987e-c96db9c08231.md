
# Workbook.ProtectSharing Method (Excel)

Saves the workbook and protects it for sharing.


## Syntax

 _表达式_. **ProtectSharing**( ** _Filename_**, ** _Password_**, ** _WriteResPassword_**, ** _ReadOnlyRecommended_**, ** _CreateBackup_**, ** _SharingPassword_**, ** _FileFormat_** )

 _表达式_ A variable that represents a **Workbook** object.


### Parameters



|**Name**|**Required/Optional**|**Data Type**|**Description**|
|:-----|:-----|:-----|:-----|
| _Filename_|可选|**Variant**|A string indicating the name of the saved file. You can include a full path; if you don?t, Microsoft Excel saves the file in the current folder.|
| _Password_|可选|**Variant**|A case-sensitive string indicating the protection password to be given to the file. Should be no longer than 15 characters.|
| _WriteResPassword_|可选|**Variant**|A string indicating the write-reservation password for this file. If a file is saved with the password and the password isn?t supplied when the file is opened, the file is opened read-only.|
| _ReadOnlyRecommended_|可选|**Variant**|**True** to display a message when the file is opened, recommending that the file be opened read-only.|
| _CreateBackup_|可选|**Variant**|**True** to create a backup file.|
| _SharingPassword_|可选|**Variant**|A string indicating the password to be used to protect the file for sharing.|
| _FileFormat_|可选|**Variant**|A string indicating the file format.|

## Remarks

请使用组合大小写字母、数字和符号的强密码。弱密码不会混合这些元素。强密码：Y6dh!et5。弱密码：House27。密码的长度应为 8 个或更多字符。使用 14 个或更多字符的通行短语更好。有关详细信息，请参阅Help protect your personal information with strong passwords。 请务必记住您的密码。如果您忘记了密码，Microsoft 无法找回它。请将您编写的密码保存在安全的位置并远离它们要帮助保护的信息。


## Example

This example saves workbook one and protects it for sharing.


```
 
Sub ProtectWorkbook() 
 
    Dim wbAWB As Workbook 
    Dim strPwd As String 
    Dim strSharePwd As String 
 
    Set wbAWB = Application.ActiveWorkbook 
 
    strPwd = InputBox("Enter password for the file") 
    strSharePwd = InputBox("Enter password for sharing") 
 
    wbAWB.ProtectSharing Password:=strPwd, _ 
        SharingPassword:=strSharePwd 
 
End Sub 

```


## 另请参阅


#### 概念


[Workbook Object](8c00aa60-c974-eed3-0812-3c9625eb0d4c.md)
#### 其他资源


[Workbook Object Members](http://msdn.microsoft.com/library/dce102a3-25de-3ff4-2ce5-bc56e08baca7%28Office.15%29.aspx)