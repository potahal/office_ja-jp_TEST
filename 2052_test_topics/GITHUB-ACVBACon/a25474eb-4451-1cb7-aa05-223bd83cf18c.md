
# 字符串中的引号

如果必须构建要连接的字符串，可能需要在一个字符串中嵌入另一个字符串，或在字符串中嵌入一个字符串变量。下列情况需要在字符串中嵌套另一个字符串：


- 为域聚合函数指定条件时。
    
- 为  **Find** 方法指定条件时。
    
- 为窗体的  **Filter** 或 **ServerFilter** 属性指定条件时。
    
- 创建 SQL 字符串时。
    

在所有这些实例中，Access 必须将字符串传递给 Microsoft Jet 数据库引擎。例如，为域聚合函数指定  _criteria_ 参数时，Access 必须计算所有的变量，将它们连接为一个字符串，然后将整个字符串传递给 Jet 数据库引擎。

如果嵌入了一个数值变量，Access 将计算该变量并简单地将值连接到字符串。然而，如果变量是文本字符串，生成的条件字符串将在字符串中包含另一个字符串。字符串中的另一个字符串必须由字符串分隔符来标识，否则，Jet 数据库引擎将不能确定应该使用该字符串的哪一部分。
字符串分隔符实际上不是变量自身的某一部分，但是它们必须包含在  _criteria_ 参数的字符串中。有三种不同的方法可以建立 _criteria_ 参数的字符串。每一种方法所产生的 _criteria_ 参数应该如下列示例之一：



```
"[LastName] = 'Smith'"
```

-或者-



```
"[LastName] = ""Smith"""
```


## 包含单引号

应该在  _criteria_ 参数中包含单引号，这样在将变量值连接到字符串中时，它就会包含在单引号中。例如，假设您的 _criteria_ 参数必须包含一个调用的字符串变量。您可以如以下示例所示构建 _criteria_ 参数：


```
"[LastName] = '" &amp; strName &amp; "'"
```

当变量求值并连接到  _criteria_ 字符串中时， _criteria_ 字符串将变为：




```
"[LastName] = 'Smith'"
```


 **注释**  这种语法不允许在变量自身的值中使用单引号 (')。如果字符串变量的值包含单引号，Access 将会产生一个运行时错误。如果变量可能代表包含单引号的值，请考虑使用在下节中讨论的其他语法形式。


## 包含双引号

应该在  _criteria_ 参数中包含双引号，这样在计算变量值时，其结果就会包含在双引号中。在字符串中，必须使用两组双引号来代表一组双引号。可以如下所示构建 _criteria_ 参数：


```
"[LastName] = """ &amp; strName &amp; """"
```

当变量求值并连接到  _criteria_ 参数中时，每组双引号被一个单引号替换。 _criteria_ 参数将变为：




```
"[LastName] = 'Smith'"
```

这种语法可能看似比单引号语法复杂，但是它允许在  _criteria_ 参数中嵌入含有一个单引号的字符串，它也允许在嵌入的字符串中嵌套一个或多个字符串。


## 包含代表双引号的变量

可以创建一个代表双引号的字符串变量，并将该变量与变量值一起连接到  _criteria_ 参数中。双引号的 ANSI 表示法是 Chr$(34)；可以将该值赋给字符串变量。然后您可以如以下示例所示构建 _criteria_ 参数：


```
"[LastName] = " &amp; strQuote &amp; strName &amp; strQuote
```

当计算出变量值并将其连接到  _criteria_ 参数中后， _criteria_ 参数变为：




```
[LastName] = "Smith"
```

