
# 使用 Document 对象的事件

 **[文档](8d83487a-2345-a036-a916-971c9db5b7fb.md)** 对象支持多个事件，使您可以对文档的状态响应。编写过程以响应这些事件，在类模块中名为"状态报告"。使用以下步骤创建事件过程。


1. 在"方案管理"窗口的 Normal 工程或文档工程下，双击"ThisDocument"。（在文件夹视图中，"ThisDocument"位于"Microsoft Word 对象"文件夹中）。
    
2. 从"对象"下拉列表框中选择"Document"。将在类模块中添加  **New** 事件的一个空子例程。
    
3. 从 **过程** 下拉列表框中选择一个事件。 所选事件的一个空子例程添加到类模块中。
    
4. 添加要在事件发生时运行的 Visual Basic 指令。
    

下面的示例演示如何创建基于常规模板的新文档时，将运行正常项目中的 **[新](c37f7e20-f429-e921-3d17-609d536e8baa.md)** 事件过程




```
Private Sub Document_New() 
 MsgBox "New document was created" 
End Sub
```

下面的示例显示 **[关闭](7758dbae-b624-d3b0-f42c-1404d40ecc78.md)** 事件过程只在该文档关闭时运行的文档项目中。



```
Private Sub Document_Close() 
 MsgBox "Closing the document" 
End Sub
```

与[自动运行的宏](65668dca-8517-5309-a89e-e19b3e85f4c6.md)不同，Normal 模板中的事件过程没有全局范围。例如，Normal 模板中的事件过程只有在附加模板为 Normal 模板时才会发生。
如果文档及其附加模板中存在自动宏，则仅运行保存在文档中的自动宏。如果文档及其附加模板中都存在文档事件过程，则两个事件过程都会运行。

## 注解

有关创建 **[应用程序](d1cf6f8f-4e88-bf01-93b4-90a83f79cb44.md)** 对象的事件过程，请参阅[使用应用程序对象的事件](784c4c61-7e47-3dbf-46f6-da655f786ca1.md)。

