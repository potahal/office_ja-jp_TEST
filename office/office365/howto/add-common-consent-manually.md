---
ms.Toctitle: Manually register your app
title: "Office 365 API にアクセスできるようにアプリを手動で Azure AD に登録する"
description: "OneDrive for Business のファイルや他のセキュリティで保護されたリソースにアクセスできるように、Azure Active Directory の共通コンテンツを手動で ASP.NET アプリケーションに追加します。"
ms.ContentId: 95479f73-15d7-426e-abdf-ae2c72b5cd33
ms.date: September 9, 2015
---
[!INCLUDE [Add the O365API repo styles](../includes/controls/addo365apistyles.xml)]



# Office 365 API にアクセスできるようにアプリを手動で Azure AD に登録する   

_**適用対象:**Office 365_
 

<a name="bk_intro"> </a>

Office 365 API サービスは、ユーザーの Office 365 データに対し、Azure Active Directory (Azure AD) を使用してセキュリティ保護された認証を行います。Office 365 API にアクセスするには、Azure AD にアプリを登録する必要があります。 


<a name="bk_RegistrationPrereqs"> </a>
##Azure AD にアプリを登録するための前提条件

アプリを登録するには、次の 2 つのアカウントが必要です。

- Office 365 ビジネス アカウント

    既存の Office 365 ビジネス アカウントをお持ちでない場合、アカウントを作成するにはいくつかの方法があります。 詳細については、「[Office 365 API にアクセスするために Office 365 アカウントを取得する](..\howto\setup-development-environment.md#bk_Office365Account)」を参照してください。

- Office 365 ビジネス アカウントに関連付けられた Azure AD サブスクリプション

    ここに、実際にアプリを登録します。 既存の Azure AD テナントを使用することも、新しいテナントを作成することもできます。
    Office 365 ビジネス アカウントにサインアップすると、自動的に Microsoft Azure サブスクリプションが作成されて、その Office 365 アカウントに関連付けられます。
    
    既存の Microsoft Azure サブスクリプションがある場合は、そのサブスクリプションを Office 365 ビジネス アカウントに関連付けることができます。 既存の Microsoft Azure サブスクリプションがない場合は、Office 365 ビジネス アカウントにサインアップしたときに作成された Azure サブスクリプションを関連付ける必要があります。
    
    詳細については、「[Office 365 アカウントを Azure AD と関連付けてアプリを作成および管理する](..\howto\setup-development-environment.md#bk_CreateAzureSubscription)」を参照してください。
    



<a name="bk_RegisterApp"> </a>
## Azure 管理ポータルにアプリを登録する 

登録の一環として、アプリが Web アプリケーション (MVC または Web フォーム ソリューションなど) であるか、ネイティブ アプリ (スマート フォンやその他のモバイル デバイスなど) であるかを指定します。Azure AD は、この情報を使用して、アプリが Azure で認証されるために必要なリソースを生成します。Web アプリケーションの場合、Azure はクライアント ID とアプリ シークレットの両方を生成します。ネイティブ アプリケーションの場合、Azure はクライアント ID を生成します。

アプリを登録した後は、アプリのプロパティを構成できます。これらのプロパティには以下が含まれます。

- Azure が認証の際にリダイレクトに使用する、アプリのエンドポイントの指定
- Web アプリケーションの場合、Azure にテナントを登録して、そのテナントだけにアプリを利用可能にするか、あるいは複数のテナントに利用可能にするか
- Web アプリケーションの場合、アプリ シークレットを生成するかどうか、およびアプリ シークレットの有効期間

アプリを登録したら、アプリがアクセスする必要のある Office 365 サービスを指定できます。Office 365 サービスを指定する際に、アプリに必要な Office 365 API に対するアクセス許可レベルも指定します。


<a name="bk_RegisterNativeApp"> </a>
### Azure 管理ポータルにネイティブ アプリを登録する 

次の手順は、iOS および Android のアプリを含むネイティブ アプリ向けのものです。 

1. Office 365 ビジネス アカウント資格情報を使用して、[Azure 管理ポータル](https://manage.windowsazure.com/)にサインインします。

2. 左側の列にある **[Active Directory]** ノードをクリックして、Office 365 サブスクリプションにリンクされているディレクトリを選択します。

    ![Azure 管理ポータル Ｗeb サイトのスクリーン ショット。 左側のナビゲーション パネルでは、[Active Directory] の項目が選択されています。 メイン ウィンドウでは、[ディレクトリ] タブが選択されています。 現在のディレクトリの名前が強調表示されています。](images\O365APIs_RegisterApp_1.png)

3. **[アプリケーション]** タブを選択してから、ページの下部にある **[追加]** を選択します。
    
    ![ディレクトリ情報のページのスクリーン ショット。 ページの下部にあるメニュー バーでは、[新規] アイコンが強調表示されています。](images\O365APIs_RegisterApp_2.png)

4. ポップアップ ウィンドウで、**[所属組織が開発しているアプリケーションの追加]** を選択します。 矢印をクリックして続行します。

5. アプリの名前を選択し、[種類] として **[ネイティブ クライアント アプリケーション]** を選択します。 矢印をクリックして続行します。
    
6. 次に、リダイレクト URI を指定します。Azure AD は OAuth 2.0 要求に対する応答として、この URI にユーザー エージェントをリダイレクトします。値は、物理的なエンドポイントである必要はありませんが、有効な URI でなければなりません。リダイレクト URL は、アプリの一意の識別子として考えることができます。
    
7. チェック マークをクリックして、アプリの登録を完了します。
    
ネイティブ アプリが Azure AD に登録されました。これで、「[Office 365 API サービスから、アプリに必要なアクセス許可レベルを指定する](#bk_ConnectAppToO365)」に進むことができます。




<a name="bk_RegisterWebApp"> </a>
### Azure の管理ポータルにブラウザー ベースの Web アプリケーションを登録する 

次の手順は、ブラウザー ベースの Web アプリケーション向けのものです。これらの種類のアプリは、サーバーからソース コードをロードした後、ブラウザーで完全に実行できるようになります。

1. Office 365 ビジネス アカウント資格情報を使用して、[Azure 管理ポータル](https://manage.windowsazure.com/)にサインインします。

2. 左側の列にある **[Active Directory]** ノードをクリックして、Office 365 サブスクリプションにリンクされているディレクトリを選択します。

    ![Azure 管理ポータル Ｗeb サイトのスクリーン ショット。 左側のナビゲーション パネルでは、[Active Directory] の項目が選択されています。 メイン ウィンドウでは、[ディレクトリ] タブが選択されています。 現在のディレクトリの名前が強調表示されています。](images\O365APIs_RegisterApp_1.png)

3. **[アプリケーション]** タブを選択してから、ページの下部にある **[追加]** を選択します。
    
    ![ディレクトリ情報のページのスクリーン ショット。 ページの下部にあるメニュー バーでは、[新規] アイコンが強調表示されています。](images\O365APIs_RegisterApp_2.png)

4. ポップアップ ウィンドウで、**[所属組織が開発しているアプリケーションの追加]** を選択します。 矢印をクリックして続行します。

5. アプリの名前を選択して、[種類] として **[Web アプリケーションまたは Web API]** を選択します。 矢印をクリックして続行します。

6. **サインオン URL** は、ユーザーがサインインしてアプリを使用できる Web ページのアドレスです。このプロパティに設定される値は、**応答 URL** の値としても設定されます。
    
7. **App ID URI** は、アプリケーションを識別する Azure AD の一意の識別子です。これは、組織の Azure AD の一意の値である必要があります。
    
7. チェック マークをクリックして、アプリの登録を完了します。
    
ブラウザー ベースの Web アプリケーションが Azure AD に登録されました。ただし、OAuth 2.0 の暗黙的な付与フローを許可するようアプリケーションを構成し、アプリの Azure テナンシー スコープを構成する必要があります。構成が完了したら、「[Office 365 API サービスから、アプリに必要なアクセス許可レベルを指定する](#bk_ConnectAppToO365)」に進むことができます。

#### OAuth 2.0 の暗黙的な付与フローを許可するようアプリケーションを構成する

ブラウザー ベースの Web アプリケーションは、アプリケーション シークレットをセキュリティ保護できないため、アプリケーションは OAuth の暗黙的な付与フローを使用します。既定では OAuth の暗黙的な付与フローは許可されていないため、これを許可するようにアプリケーションのマニフェストを更新する必要があります。

1. Azure の管理ポータルで、アプリケーションのエントリの **[構成]** タブを選択します。

2. ドロワーの **[マニフェストの管理]** ボタンを使用して、アプリケーションのマニフェスト ファイルをダウンロードし、コンピューターに保存します。

3. テキスト エディターでマニフェスト ファイルを開きます。 *oauth2AllowImplicitFlow* プロパティを検索します。 既定では *false* に設定されています。*true* に変更してファイルを保存します。

4. **[マニフェストの管理]** ボタンを使用して、更新したマニフェスト ファイルをアップロードします。

#### Web アプリを単一テナント アプリまたはマルチテナント アプリのどちらにするかを指定する

ブラウザー ベースのアプリケーションの場合、アプリの Azure テナント範囲を構成することもできます。つまり、Azure にテナントを登録して、そのテナントだけにアプリを利用可能にするか、あるいは複数の Axure テナントに利用可能にするかを指定します。 

既定値は **[いいえ]** です。 テナント範囲は、必要に応じて後から変更できます。

1. Azure 管理ポータルで、アプリケーションを選択し、上部メニューの **[構成]** を選択します。**[マルチ テナント型アプリケーションにする]** までスクロールダウンして、**[はい]** または **[いいえ]** を選択します。






<a name="bk_RegisterServerApp"> </a>
### Azure の管理ポータルに Web サーバー アプリを登録する 

次の手順は、Node.js アプリなど、Web サーバー アプリ向けのものです。

1. Office 365 ビジネス アカウント資格情報を使用して、[Azure 管理ポータル](https://manage.windowsazure.com/)にサインインします。

2. 左側の列にある **[Active Directory]** ノードをクリックして、Office 365 サブスクリプションにリンクされているディレクトリを選択します。

    ![Azure 管理ポータル Ｗeb サイトのスクリーン ショット。 左側のナビゲーション パネルでは、[Active Directory] の項目が選択されています。 メイン ウィンドウでは、[ディレクトリ] タブが選択されています。 現在のディレクトリの名前が強調表示されています。](images\O365APIs_RegisterApp_1.png)

3. **[アプリケーション]** タブを選択してから、ページの下部にある **[追加]** を選択します。
    
    ![ディレクトリ情報のページのスクリーン ショット。 ページの下部にあるメニュー バーでは、[新規] アイコンが強調表示されています。](images\O365APIs_RegisterApp_2.png)

4. ポップアップ ウィンドウで、**[所属組織が開発しているアプリケーションの追加]** を選択します。 矢印をクリックして続行します。

5. アプリの名前を選択して、[種類] として **[Web アプリケーションまたは Web API]** を選択します。 矢印をクリックして続行します。

6. **サインオン URL** は、ユーザーがサインインしてアプリを使用できる Web ページのアドレスです。このプロパティに設定される値は、**応答 URL** の値としても設定されます。
    
7. **App ID URI** は、アプリケーションを識別する Azure AD の一意の識別子です。これは、組織の Azure AD の一意の値である必要があります。
    
7. チェック マークをクリックして、アプリの登録を完了します。
    
Web サーバー アプリが Azure AD に登録されました。ただし、アプリ シークレットを生成して、クライアントがサーバー アプリケーションで認証できるようにする必要があります。その後、「[Office 365 API サービスから、アプリに必要なアクセス許可レベルを指定する](#bk_ConnectAppToO365)」に進むことができます。

<a name="bk_ConfigureApp_Secret"> </a>
#### Web アプリケーションの新しいアプリ シークレットを生成する

1. Azure 管理ポータルで、アプリケーションを選択し、上部メニューの **[構成]** を選択します。 **[キー]** までスクロールダウンします。

2. クライアント シークレットの有効期間を選択して、[保存] アイコンをクリックします。

    ![Azure 管理ポータル Web サイト上のアプリケーションのアプリケーション構成ページのスクリーン ショット。 [キー] というタイトルのページ セクションに、新しいキーの期間を選択するためのドロップ ダウン リストが表示されています。 ページの下部にあるメニュー バーでは、[保存] アイコンが強調表示されています。](images\O365APIs_RegisterApp_7.png)
    
    Azure に、アプリ シークレットが表示されます。

3. クリップボード アイコンをクリックし、クライアント シークレットをクリップボードにコピーします。

    ![Azure 管理ポータル Web サイト上のアプリケーションのアプリケーション構成ページのスクリーン ショット。 [キー] というタイトルのページ セクションに、新しいクライアント シークレットが表示されています。 クライアント シークレットの横にあるクリップボード アイコンが強調表示されています。](images\O365APIs_RegisterApp_8.png)

    **重要** クライアント シークレットは、最初に生成したときにだけ、Azure に表示されます。 後でこのページに戻ってクライアント シークレットを取得することはできません。 



<a name="bk_ConnectAppToO365"> </a>
## アプリが必要とする Office 365 API のアクセス許可を指定する 

最後に、アプリに必要な Office 365 API の具体的なアクセス許可を指定する必要があります。それには、アプリに必要な API が含まれる Office 365 サービスへのアクセスを追加してから、そのサービスの API から必要なアクセス許可を指定します。Office 365 API のアクセス許可の完全なリストについては、「[Office 365 アプリケーション マニフェストとアクセス許可の詳細](..\howto\application-manifest.md)」を参照してください。  

1. Azure 管理ポータルで、アプリケーションの構成ページの一番下までスクロールダウンし、**[他のアプリケーションへのアクセス許可]** で **[アプリケーションの追加]** を選択します。
 
    ![Azure 管理ポータル Web サイト上のアプリケーションのアプリケーション構成ページのスクリーン ショット。 [他のアプリケーションへのアクセス許可] というタイトルのページ セクションでは、[アプリケーションの追加] ボタンが強調表示されています。](images\O365APIs_RegisterApp_4.png)

2. アプリがアクセス許可を必要とする Office 365 のサービスを選択します。
    

    1. サービス名を選択し、プラス記号をクリックしてサービスを追加します。 
    2. 追加したサービスが **[選択済み]** 列にリストされます。 
    3. チェック マーク アイコンをクリックして、選択を保存してください。
    ![[他のアプリケーションへのアクセス許可] ページのスクリーン ショット。 利用可能なサービスが、表に一覧表示されています。 選択されたサービスの名前の横に、プラス記号のアイコンがあります。 右端の列には、アプリに追加するアプリケーションが一覧表示されています。 ページ上部にある、選択内容を保存する場合にクリックするチェック マーク アイコンが強調表示されています。](images\O365APIs_RegisterApp_5.png)

    アプリの構成ページが再表示されます。

4. **[他のアプリケーションへのアクセス許可]** で、追加した各サービスの **[デリゲートされたアクセス許可]** 列をクリックし、アプリに必要なアクセス許可を指定します。

    ![Azure 管理ポータル Web サイト上のアプリケーションのアプリケーション構成ページのスクリーン ショット。 [他のアプリケーションへのアクセス許可] というタイトルのページ セクションの表に、追加したサービスが一覧表示されています。 各アプリケーションの名前の横に、[デリゲートされたアクセス許可] というタイトルの列があります。 この列には、アクセス許可のドロップ ダウン メニューが表示されています。これを使用して、追加したアプリケーションに、アプリに必要なアクセス許可を要求できます。](images\O365APIs_RegisterApp_6.png)

    指定したアクセス許可は、アプリのユーザーに対し、Azure がアプリのアクセス許可要求に同意するように求める場合に表示されます。 一般に、アプリが実際に必要とするサービスのみを要求し、アプリがその機能を実行できる各サービスの最低レベルのアクセス許可を指定します。

    また、アクセス許可レベルには、その下のレベルのアクセス許可が含まれることに注意してください。 つまり、より広範なアクセス許可レベルには、それよりも下のレベルのより制限されたアクセス許可がすでに含まれるため、特定の API に対して複数のアクセス許可を要求する必要はありません。 たとえば、メール API の場合、**[ユーザーとしてメールを送信する]** アクセス許可には、**[ユーザーのメールの読み取りと書き込み]** アクセス許可がすでに含まれています。
    
    具体的なアクセス許可の詳細については、「[Office 365 アプリケーション マニフェストとアクセス許可の詳細](..\howto\application-manifest.md)」を参照してください。


<a name="bk_NextSteps"> </a>
## 次の手順

アプリを登録し、構成し、Office 365 サービスに接続した後は、Azure AD でアプリを認証してユーザーの Office 365 データにアクセスするためのコードをアプリに追加できます。

次のセクションにリストされているスタート プロジェクト、サンプル コード、手順のトピック、参照資料を利用して、アプリを使用可能な状態にするために必要な設定を行ってください。

<a name="bk_AdditionalResources"> </a>
## その他のリソース

- [Office 365 API スタート プロジェクト、サンプル コード、ビデオ](..\howto\starter-projects-and-code-samples.md)

- [Office 365 API リファレンス](..\api\api-catalog.md)

- [Office 365 プラットフォーム上での開発の概要](..\howto\platform-development-overview.md)

- [Office 365 のアプリケーション マニフェストとアクセス許可の詳細](..\howto\application-manifest.md)
